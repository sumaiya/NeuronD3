<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>D3 fun</title>
        <script type="text/javascript" src="d3/d3.v3.js"></script>
        <style type="text/css">

        body {
            background-color: #000;
            color: #fff;
        }

        .node {
          stroke: #000;
          fill: #c9f;
          stroke-width: .5px;
        }

        .link {
          stroke: #999;
          stroke-width: .5px;
          stroke-opacity: .2;
        }

        </style>
    </head>

    <body>
        <a href="#" onclick="setSpecies('rodent');">Rodent</a>
        Human
        Fish
        <script type="text/javascript">

        var neuron_nums = {"human": 2000, "rodent": 100, "fish": 5};
        var neuron_num = neuron_nums["human"];

        var setSpecies = function(species) {
            neuron_num = neuron_nums[species];
            force.start();
        }

        var w = 750;
        var h = 600;
        var connections_num = neuron_num/1000

        var connections = [{"source": 0, "target": 1}];

        var neurons = [];
        for (var i=0; i<neuron_num; i++) {
            neurons[i] = {};
        }

        connections = []
        for (var i=0; i<connections_num; i++) {
            d3.range(neuron_num)
            .map(function(x) { 
                connections.push({"source":x , "target":Math.floor(Math.random() * neuron_num)});
            });
        };

        var force = d3.layout.force()
                    .charge(-5)
                    .nodes(neurons)
                    .gravity(.6)
                    .links(connections)
                    .size([w,h])
                    .start();

        var svg = d3.select("body")
                  .append("svg")
                  .attr("width", w)
                  .attr("height", h);

        var link = svg.selectAll(".link")
                  .data(connections)
                  .enter().append("line")
                  .attr("class", "link");

        var node = svg.selectAll(".node")
                  .data(neurons)
                  .enter().append("circle")
                  .attr("class", "node")
                  .attr("r", 3)
                  .call(force.drag);


     force.on("tick", function() {
        link.attr("x1", function(d) { return d.source.x; })
            .attr("y1", function(d) { return d.source.y; })
            .attr("x2", function(d) { return d.target.x; })
            .attr("y2", function(d) { return d.target.y; });

        node.attr("cx", function(d) { return d.x; })
            .attr("cy", function(d) { return d.y; });

      });
        </script>

    </body>
</html>     
