<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>D3 fun</title>
        <script type="text/javascript" src="d3/d3.v3.js"></script>
        <style type="text/css">

        body {
            background-color: #000;
            color: #fff;
        }

        .node {
          stroke: #001;
          fill: #39f;
          stroke-width: .5px;
        }

        .link {
          stroke: #00f;
          stroke-width: .5px;
          stroke-opacity: .2;
        }

        </style>
    </head>

    <body>
        <a href="#" onclick="reset('rodent');">Rodent</a>
        <a href="#" onclick="reset('fish');">Fish</a>
        Human
        <script type="text/javascript">


        var w = 700;
        var h = 700;
        var r = 7.5;
        var neurons = [];
        var connections = [];

        var setup = function() {
            var neuron_num = 500;

            var connections_num = neuron_num/100

            for (var i=0; i<neuron_num; i++) {
                neurons[i] = {"weight": 3};
            }
        
            for (var i=0; i<connections_num; i++) {
                d3.range(neuron_num)
                .map(function(x) { 
                    connections.push({"source":x , "target":Math.floor(Math.random() * neuron_num)});
                });
            };
        };

        setup();

        var force = d3.layout.force()
                    .nodes(neurons)
                    .links(connections)
                    .size([w, h])
                    .linkDistance(function() { return Math.random() * 20; })
                    .charge([-1000])
                    .friction(0.5)
                    .gravity(0.5)
                    .theta(0.5)
                    .start();

        var svg = d3.select("body")
                  .append("svg")
                  .attr("width", w)
                  .attr("height", h);

        var link = svg.selectAll(".link")
                  .data(connections)
                  .enter().append("line")
                  .attr("class", "link");

        var node = svg.selectAll(".node")
                  .data(neurons)
                  .enter().append("ellipse")
                  .attr("class", "node")
                  .attr("rx", function() { return (Math.random() * r)/2; })
                  .attr("ry", function() { return Math.random() * r; })
                  .call(force.drag);


     force.on("tick", function() {
        link.attr("x1", function(d) { return d.source.x; })
            .attr("y1", function(d) { return d.source.y; })
            .attr("x2", function(d) { return d.target.x; })
            .attr("y2", function(d) { return d.target.y; });

        node.attr("cx", function(d) { return Math.max(r, Math.min(d.x, w - r)); })
            .attr("cy", function(d) { return Math.max(r, Math.min(d.y, h - r)); });

        // node.attr("cx", function(d) { 
        //     return d.x = Math.max(r, Math.min(w - r, d.x)); 
        // }) 
        // .attr("cy", function(d) { 
        //     return d.y = Math.max(r, Math.min(h - r, d.y)); 
        // });
      });


        // var reset = function(species) {
        //     species = species || "human";
            
        //     var neuron_nums = {"human": 500, "rodent": 100, "fish": 5};

        //     neuron_num = neuron_nums[species];
        //     connections_num = neuron_num/100;
        //     neurons = [];
        //     connections = [];

        //     for (var i=0; i<neuron_num; i++) {
        //         neurons[i] = {"weight": 3};
        //     }
        
        //     for (var i=0; i<connections_num; i++) {
        //         d3.range(neuron_num)
        //         .map(function(x) { 
        //             connections.push({"source":x , "target":Math.floor(Math.random() * neuron_num)});
        //         });
        //     };  

        //     force.nodes(neurons)
        //         .links(connections)
        //         .start();
        // };

        </script>

    </body>
</html>     
